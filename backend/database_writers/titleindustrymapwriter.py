import sys
sys.path.insert(0,"../utils")
from utils.skillscout_connection_utilities import PostgresqlDB

lTitleIndustryMap = [{'title': "Accountant", 'industry': 'Financial and Insurance Services'}, {'title': "Actuary", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Advertising Managers and Promotions Managers", 'industry': 'Retail Trade'}, {'title': "Advertising Sales Agent", 'industry': 'Retail Trade'}, {'title': "Aircraft Mechanic", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Airline Pilot", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Airport Security Screener", 'industry': 'Public Administration and Safety'}, {'title': "Airline Reservations Agent", 'industry': 'Administrative and Support Services'}, {'title': "Air Traffic Controller", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Architect", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Auto Mechanic", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Bank Teller", 'industry': 'Administrative and Support Services'}, {'title': "Bartender", 'industry': 'Accommodation and Food Services'}, {'title': "Biological Technician", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Biomedical Engineer", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Bookkeeping, Accounting, and Auditing Clerks", 'industry': 'Financial and Insurance Services'}, {'title': "Brick Mason", 'industry': 'Construction'}, {'title': "Budget Analyst", 'industry': 'Financial and Insurance Services'}, {'title': "Cardiovascular Technologist", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Cashier", 'industry': 'Administrative and Support Services'}, {'title': "Chef", 'industry': 'Accommodation and Food Services'}, {'title': "Chief Executive Officer (CEO)", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Chemical Technician", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Childcare Worker", 'industry': 'Administrative and Support Services'}, {'title': "Chiropractor", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Claims Adjuster, Appraiser, Examiner, and Investigator", 'industry': 'Financial and Insurance Services'}, {'title': "Compensation and Benefits Manager", 'industry': 'Financial and Insurance Services'}, {'title': "Computer Programmer", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Computer Systems Analyst", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Construction Laborer", 'industry': 'Construction'}, {'title': "Consultant", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Cook", 'industry': 'Accommodation and Food Services'}, {'title': "Correctional Officer", 'industry': 'Public Administration and Safety'}, {'title': "Court Reporter", 'industry': 'Administrative and Support Services'}, {'title': "Curator", 'industry': 'Arts and Recreation Services'}, {'title': "Customer Service Representative", 'industry': 'Retail Trade'}, {'title': "Database Administrator", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Dental Hygienist", 'industry': 'Health Care and Social Assistance'}, {'title': "Dentist", 'industry': 'Health Care and Social Assistance'}, {'title': "Derrick Operator", 'industry': 'Construction'}, {'title': "Diagnostic Medical Sonographer", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Director", 'industry': 'Arts and Recreation Services'}, {'title': "Dietitian/Nutritionist", 'industry': 'Health Care and Social Assistance'}, {'title': "Doctor", 'industry': 'Health Care and Social Assistance'}, {'title': "Editor", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Electrician", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "EMTs and Paramedics", 'industry': 'Public Administration and Safety'}, {'title': "English as a Second Language (ESL) Teacher", 'industry': 'Education and Training'}, {'title': "Epidemiologist", 'industry': 'Public Administration and Safety'}, {'title': "Event/Meeting Planner", 'industry': 'Accommodation and Food Services'}, {'title': "Fashion Designer", 'industry': 'Arts and Recreation Services'}, {'title': "Financial Advisor", 'industry': 'Financial and Insurance Services'}, {'title': "Financial Manager", 'industry': 'Financial and Insurance Services'}, {'title': "Financial Services Sales", 'industry': 'Financial and Insurance Services'}, {'title': "Firefighter", 'industry': 'Public Administration and Safety'}, {'title': "Fitness Trainer", 'industry': 'Arts and Recreation Services'}, {'title': "Flight Attendant", 'industry': 'Administrative and Support Services'}, {'title': "Funeral Director", 'industry': 'Administrative and Support Services'}, {'title': "Fundraiser", 'industry': 'Administrative and Support Services'}, {'title': "Judge", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Glazier", 'industry': 'Construction'}, {'title': "Grant Writer", 'industry': 'Administrative and Support Services'}, {'title': "Graphic Designer", 'industry': 'Arts and Recreation Services'}, {'title': "Guidance Counselor", 'industry': 'Administrative and Support Services'}, {'title': "Hairdressers, Hairstylists, and Cosmetologists", 'industry': 'Administrative and Support Services'}, {'title': "Health Educator", 'industry': 'Education and Training'}, {'title': "Human Resources Assistant", 'industry': 'Administrative and Support Services'}, {'title': "Human Resources Manager", 'industry': 'Administrative and Support Services'}, {'title': "Home Health Aide", 'industry': 'Health Care and Social Assistance'}, {'title': "Housekeeper", 'industry': 'Administrative and Support Services'}, {'title': "Industrial Designer", 'industry': 'Manufacturing'}, {'title': "Industrial Production Manager", 'industry': 'Manufacturing'}, {'title': "Insurance Underwriter", 'industry': 'Financial and Insurance Services'}, {'title': "Interior Designer", 'industry': 'Arts and Recreation Services'}, {'title': "Interpreter and Translator", 'industry': 'Administrative and Support Services'}, {'title': "Janitor", 'industry': 'Administrative and Support Services'}, {'title': "Lawyer", 'industry': 'Financial and Insurance Services'}, {'title': "Librarian", 'industry': 'Administrative and Support Services'}, {'title': "Library Assistant/Technician", 'industry': 'Administrative and Support Services'}, {'title': "Licensed Practical Nurse", 'industry': 'Health Care and Social Assistance'}, {'title': "Loan Officer", 'industry': 'Financial and Insurance Services'}, {'title': "Lodging Manager", 'industry': 'Accommodation and Food Services'}, {'title': "Manicurist", 'industry': 'Administrative and Support Services'}, {'title': "Manufacturing Sales Representative", 'industry': 'Manufacturing'}, {'title': "Market Research Analyst", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Marriage and Family Therapist", 'industry': 'Health Care and Social Assistance'}, {'title': "Massage Therapist", 'industry': 'Administrative and Support Services'}, {'title': "Mechanical Engineer", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Medical Assistant", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Medical Laboratory Technician", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Model", 'industry': 'Arts and Recreation Services'}, {'title': "Nurse Practitioner", 'industry': 'Health Care and Social Assistance'}, {'title': "Nursing Assistant", 'industry': 'Health Care and Social Assistance'}, {'title': "Occupational Therapist", 'industry': 'Health Care and Social Assistance'}, {'title': "Occupational Therapy Assistant", 'industry': 'Health Care and Social Assistance'}, {'title': "Painter", 'industry': 'Arts and Recreation Services'}, {'title': "Paralegal and Legal Assistant", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Personal Trainer", 'industry': 'Arts and Recreation Services'}, {'title': "Pharmacist", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Pharmacy Technician", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Physician Assistant", 'industry': 'Health Care and Social Assistance'}, {'title': "Photographer", 'industry': 'Arts and Recreation Services'}, {'title': "Physical Therapist", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Physical Therapy Assistant", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Plumber", 'industry': 'Construction'}, {'title': "Police Officer", 'industry': 'Public Administration and Safety'}, {'title': "Postal Service Worker", 'industry': 'Public Administration and Safety'}, {'title': "Producer", 'industry': 'Arts and Recreation Services'}, {'title': "Psychiatric Aide", 'industry': 'Health Care and Social Assistance'}, {'title': "Public Relations Specialist", 'industry': 'Public Administration and Safety'}, {'title': "Purchasing Manager", 'industry': 'Wholesale Trade'}, {'title': "Receptionist", 'industry': 'Administrative and Support Services'}, {'title': "Registered Nurse", 'industry': 'Health Care and Social Assistance'}, {'title': "Retail Salesperson", 'industry': 'Retail Trade'}, {'title': "Retail Supervisor", 'industry': 'Retail Trade'}, {'title': "Roofer", 'industry': 'Construction'}, {'title': "Secretary / Administrative Assistant", 'industry': 'Administrative and Support Services'}, {'title': "Security Guard", 'industry': 'Public Administration and Safety'}, {'title': "Social Media Manager", 'industry': 'Information Media and Telecommunications'}, {'title': "Social Worker", 'industry': 'Health Care and Social Assistance'}, {'title': "Software Developer", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Special Education Teacher", 'industry': 'Education and Training'}, {'title': "Subway Operator", 'industry': 'Transport, Postal and Warehousing'}, {'title': "Taxi Driver", 'industry': 'Transport, Postal and Warehousing'}, {'title': "Teacher", 'industry': 'Education and Training'}, {'title': "Teacher Assistant", 'industry': 'Education and Training'}, {'title': "Technical Writer", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Training and Development Manager", 'industry': 'Education and Training'}, {'title': "Veterinarian", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Waiter/Waitress", 'industry': 'Accommodation and Food Services'}, {'title': "Web Developer", 'industry': 'Professional, Scientific, Technical Services'}, {'title': "Writer", 'industry': 'Arts and Recreation Services'}]

print "Connecting..."
oPostgresql = PostgresqlDB() # db object
print "Done."

# query string (seperated into multiple lines for readability, same for every city loop)
for dTitleIndustryMap in lTitleIndustryMap:
    tValues = (dTitleIndustryMap['title'].lower(), dTitleIndustryMap['industry'].lower())
    sQuery = "INSERT INTO title_industry_map (title, industry) VALUES (%s, %s) ON CONFLICT (title) DO NOTHING"
    oPostgresql.execute(sQuery, tValues)

# done with loop of transactions, commit them to the db
print "Commiting..."
oPostgresql.commit()
print "Done."
oPostgresql.close()
print "Connection closed."
