# imports
import os
import psycopg2

# DB Credentials (in bashrc)
DB_NAME = os.environ.get("SKILLSCOUT_DB_NAME")
DB_USER = os.environ.get("SKILLSCOUT_DB_USER")
DB_PASSWORD = os.environ.get("SKILLSCOUT_DB_PASSWORD")
DB_HOST = os.environ.get("SKILLSCOUT_DB_HOST")
DB_PORT = os.environ.get("SKILLSCOUT_DB_PORT")

# top skills taken from linkedin list of 'popular topic' a-z: https://www.linkedin.com/directory/topics-a/
skills =  ["Account Management", "Advertising", "Auditing", "AutoCAD", "Analytical Skills", "Adobe Photoshop", "Automotive", "Art Direction", "Automation", "Adobe Illustrator", "Business Planning", "Business", "Budgeting", "Business Strategy", "Business Process Improvement", "Business Services", "Business Analysis", "Branding", "Business-to-Business (B2B)", "Business Process", "Communication", "Company Research", "Change Management", "Coaching", "Customer Relationship Management (CRM)", "Customer Satisfaction", "Contract Negotiation", "Corporate Law", "Consulting", "Commercial Real Estate", "Design", "Databases", "Data Analysis", "Digital Marketing", "Decision-Making", "Digital Media", "Drawing", "Development Tools", "Direct Sales", "Due Diligence", "English", "Engineering", "Event Planning", "Education", "Editing", "Entrepreneurship", "Email", "Employee Benefits Design", "Energy", "Electronics", "Financial Analysis", "Fundraising", "Facility Management (FM)", "Food & Beverage", "Forecasting", "Facilitation", "Financial Risk", "Financial Reporting", "Facebook", "Future Trends", "Government Agencies", "Grocery", "Government", "Graphic Design", "Google ", "Groups", "Gas", "Graphics", "Grant Writing", "General Ledger", "German", "HTML", "Heavy Equipment", "Hospitals", "Higher Education", "Hospitality Industry", "Healthcare", "Helping Clients Succeed", "History", "Hotel Management", "Healthcare Management", "Insurance", "Inventory Management", "Interpersonal Skills", "Information Systems", "Internal Audit", "Integration", "Investments", "Interviewing", "Invoicing", "Inspection", "Java", "JavaScript", "JQuery", "Journalism", "Java Enterprise Edition", "Journals", "Journal Entries", "Joint Ventures", "JIRA", "JavaServer Pages (JSP)", "Key Performance Indicators", "Kaizen", "K-12 Education", "Knowledge Management", "Kanban", "Key Account Development", "Knowledge Sharing", "Knowledge Base", "KYC", "Kindergarten", "Leadership", "Logistics Management", "Local Marketing", "Legal Issues", "Linux", "Leadership Development", "Laboratory Skills", "Lean Manufacturing", "Litigation", "Legal Writing", "Management", "Microsoft Office", "Microsoft Excel", "Microsoft Word", "Microsoft PowerPoint", "Marketing Strategy", "Maintenance", "Manufacturing", "Materials", "Microsoft Outlook", "Negotiation", "Nonprofit Organizations", "New Business Opportunities", "Newsletters", "New Hires", "Nursing", "Network Communications", "Network Administration", "Network Systems", "Network-Attached Storage (NAS)", "Online Advertising", "Order Fulfillment", "Operating Systems", "Organizational Development", "Oracle HR", "Operations Management", "Organizational Structure", "Oracle Database", "Office Administration", "Outsourcing", "Problem Solving", "Project Management", "Public Speaking", "Product Development", "Public ", "Policy", "Performance Tuning", "Partnerships", "Presentations", "Pricing Strategy", "Photography", "Quality Assurance", "Qualitative Research", "Quality Management", "QuickBooks", "Queues", "Quality System", "Quotations", "Quality Auditing", "Quantitative Research", "Quality Improvement", "Research", "Retail", "Recruiting", "Risk Management", "Reviews", "Requirements Analysis", "Range", "Regulations", "Residential Homes", "Records", "Social Media", "Staff Development", "Strategy", "Supervisory ", "Skills", "SQL", "Software Documentation", "Schedules", "Security", "System Monitoring", "Software Development", "Training", "Team Leadership", "Teamwork", "Team Building", "Time Management", "Team Management", "Troubleshooting", "Telecommunications", "Travel", "Tax", "Unix", "User Interface Design", "User Experience", "U.S. Health Insurance Portability and Accountability Act (HIPAA)", "Underwriting", "U.S. Department of Defense", "Unified Modeling Language (", "UML)", "University Teaching", "User Acceptance Testing", "Utilization", "Vendor Management", "Video", "Video Production", "Volunteering", "Volunteer Management", "Vendors", "Validation", "Visual Merchandising", "Video Editing", "Visio","Windows", "Writing", "Web Design", "Warehouse Operations", "Windows Server", "Web Applications", "Workshops", "Water Resource Management", "WordPress", "Wireless Technologies", "Xbox 360", "XML", "XHTML", "X-ray", "XSLT", "Xcode", "Xilinx", "Xen", "XSL", "XAML", "YAML", "YMS", "YSlow", "YUM", "Yacc", "Yacht Charters", "Yacht Racing", "Yachting", "Yahoo Search", "Yahoo Search Marketing", "Yahoo!", "Yamaha M7CL", "Yamaha PM5D", "Yammer", "Yantra", "Yard Management", "Yard Signs", "Yard Work", "Yardi", "Yarn", "Yaskawa", "Year-end Close", "Yearbook", "Yeast", "Yeast two-hybrid", "Yellow Belt", "Yellow Book", "Yellow Pages", "Yelp", "Yelp, Inc.", "Yeoman", "Yiddish", "Yield", "Yield Management", "Yields", "Yii", "Yin ", "Yoga", "Yo", "Yo", "Yoga", "Yoga Instruction", "Yoga Nidra", "Yogurt", "Yooda", "Yooda Insight", "Yoruba", "Yosemite", "YouTube", "YouTube API", "Young Adult Literature", "Young Adults", "Young People", "Young Professionals", "Yourdon", "Youth Activism", "Youth Advocacy", "Youth At Risk", "Youth Culture", "Youth Development", "Youth Empowerment", "Youth Engagement", "Youth Entrepreneurship", "Youth Groups", "Youth Justice", "Youth Leadership", "Youth Leadership Training", "Youth Marketing", "Youth Media", "Youth Mentoring", "Youth Ministry", "Youth Organizations", "Youth Outreach", "Youth Participation", "Youth Programs", "Youth Services", "Youth Work", "Yelp.com", "Z-Shell", "Z-Wave", "Z1", "Z80", "ZBrush", "ZFS", "ZK", "ZURB", "Zabbix", "Zachman", "Zapier", "ZaxWorks", "Zebra", "Zebrafish", "Zedo", "Zeichnen", "Zeiss", "Zemax", "Zen", "Zen Shiatsu", "ZenCart", "Zend", "Zend Certified Engineer", "Zend Framework", "Zend Server", "Zend Studio", "Zendesk", "Zenoss", "Zenworks", "Zeolites", "Zephyr", "Zeplin", "Zero Defects", "Zero Waste", "Zero-based Budgeting", "ZeroMQ", "Zeta Potential", "Zeus", "ZigBee", "Zillow", "Zimbra", "Zinc", "Zines", "Zmap", "Zoho", "Zombies", "Zone Alarm", "Zoning", "Zoo", "Zooarchaeology", "Zoology", "Zoom", "ZoomInfo", "Zope", "Zotero", "Zsh", "Zuken", "Zultys", "Zulu Education Products", "ZuluDesk", "Zumba", "Zuora", "Zyxel", "Z/OS", "Z/VM", "ZLinux", "ZSeries"]

################################################################
### Connect to DB and get all cities / endpoints for website ###
################################################################
print "Connecting..."
conn = psycopg2.connect(dbname=DB_NAME, user=DB_USER, password=DB_PASSWORD, host=DB_HOST, port=DB_PORT) # connect to db
cur = conn.cursor() # Open a cursor to perform database operations
print "Done."

# query string (seperated into multiple lines for readability, same for every city loop)
sQuery = "INSERT INTO skills (skill) VALUES (%s) ON CONFLICT (skill) DO NOTHING"

for i in range(0, len(skills)):
    # write the skill into the DB
    cur.execute(sQuery, (skills[i],)) # note the weird () with the , is required for psycopg2 syntax...
    print "Skill data line " + str(i) + " of " + str(len(skills)) + " complete..."

# done with loop of transactions, commit them to the db
print "Commiting..."
conn.commit()
print "Done."
conn.close()
print "Connection closeed."
